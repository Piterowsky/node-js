<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <title>Title</title>
        <script src="https://apis.google.com/js/platform.js" async defer></script>
        <meta
            name="google-signin-client_id"
            content="216494072492-cr7jbjlmip6fu8n7j4sm2f4l7com7tu8.apps.googleusercontent.com"
        />
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" />
        <link rel="stylesheet" href="main.css">
    </head>
    <body>
        <div class="container">
            <div class="jumbotron">
                <h1 class="text-center text-success">Login</h1>
                <form action="auth" method="post">
                    <div class="form-group">
                        <div class="input-group">
                            <label for="username">Username</label>
                            <br />
                            <input id="username" type="text" name="username" />
                        </div>
                        <div class="input-group">
                            <label for="password">Password</label>
                            <br />
                            <input id="password" type="password" name="password" />
                        </div>
                        <input type="submit" class="btn btn-success" value="Login" />
                        <button id="registerButton" class="btn btn-secondary">Register</button>
                        <div class="g-signin2" data-onsuccess="onSignIn">Google</div>
                    </div>
                </form>
            </div>
        </div>

        <script>
            document.querySelector('#registerButton').addEventListener('click', (e) => {
                e.preventDefault();
                window.location.href = 'registration.html';
            });

            async function onSignIn(googleUser) {
                const profile = googleUser.getBasicProfile();
                const body = {
                    googleId:  profile.getId(),
                    username: profile.getName(),
                    email: profile.getEmail(),
                };
                await fetch('/googleLogin', {
                    method: 'POST',
                    headers: {
                        "Content-type": "application/json",
                    },
                    body: JSON.stringify(body),
                });
                window.location.href = '/home';
            }
        </script>
    </body>
</html>
